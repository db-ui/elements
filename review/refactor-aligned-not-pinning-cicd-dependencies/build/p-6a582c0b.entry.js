import{r as t,h as s,H as i}from"./p-0b532a55.js";const e=class{constructor(s){t(this,s),this._defaultBranch="latest",this.groups=[{name:"Versions",branches:[]},{name:"Features",branches:[]},{name:"Bugfixes",branches:[]},{name:"Other",branches:[]}],this.currentBranch=this._defaultBranch,this.stripString=t=>t.replace(/[^a-zA-Z0-9-]/g,""),this.fetchFromGitHubApi=async t=>{const s=await fetch(t);return await s.json()},this.setCurrentBranch=t=>{const s=window.location.href,i=t.find((t=>s.includes(t)));i&&(this.currentBranch=i)},this.setBranches=t=>{const s=t.map((t=>t.name)).filter((t=>"gh-pages"!==t&&!t.includes("dependabot")));s.forEach((t=>{t.startsWith("feat")||t.startsWith("feature")?this.groups[1].branches.push(t):t.startsWith("fix")||t.startsWith("bugfix")?this.groups[2].branches.push(t):this.groups[3].branches.push(t)})),this.setCurrentBranch(s)},this.setTags=t=>{const s=t.map((t=>t.name));s.forEach((t=>{this.groups[0].branches.push(t)})),this.setCurrentBranch(s)}}get defaultBranch(){return this._defaultBranch}set defaultBranch(t){this._defaultBranch=t}async componentWillLoad(){const t=this.stripString(this.owner);this.cleanOwner=t;const s=this.stripString(this.repo);this.cleanRepo=s;const i=await this.fetchFromGitHubApi(`https://api.github.com/repos/${t}/${s}/branches`);this.setBranches(i);const e=await this.fetchFromGitHubApi(`https://api.github.com/repos/${t}/${s}/tags`);this.setTags(e)}handleChange(t,s,i){if(s&&i){const e=top.location.href.split("?"),h=e[e.length-1],a=3===t.split(".").length&&t.startsWith("v");top.location=`https://${s}.github.io/${i}${this._defaultBranch===t?"":`${a?"/version":"/review"}/${t}`}/?${h}`}}render(){var t;return s(i,null,(null===(t=this.groups)||void 0===t?void 0:t.length)>0&&s("db-select",{class:"gh-version-switcher",label:"Version",name:"Theme",onDbChange:t=>this.handleChange(t.target.value,this.cleanOwner,this.cleanRepo)},s("option",{value:this._defaultBranch,selected:this.currentBranch===this._defaultBranch},this._defaultBranch),this.groups.filter((t=>{var s;return(null===(s=t.branches)||void 0===s?void 0:s.length)>0})).map((t=>s("optgroup",{key:t.name,label:t.name},t.branches.map(((i,e)=>s("option",{key:`${t.name}-${i}-${e}`,value:i,selected:this.currentBranch===i},i))))))))}};e.style=".gh-version-switcher select{max-width:196px}";export{e as github_version_switcher}