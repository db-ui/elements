{"version":3,"names":["dbTableCss","DbTableStyle0","DbTable","exports","this","errorTableData","caption","headers","columns","rows","error","undefined","class_1","prototype","validateTableData","newTableData","columnKeys","Object","keys","isHeader","length","isRowAndColumn","Array","isArray","console","validTableData","componentWillLoad","parseTabularData","tabledata","item","JSON","parse","calcColumnLength","tableHeaders","tableColumns","reduce","prevCol","currentCol","isRowData","tableData","render","_b","rowTitles","rowTitle","maxColumnLength","columnIter","__spreadArray","showRowTitles","h","key","class","border","density","style","fontsize","stripes","sticky","align","verticalalign","scope","map","head","index","concat","bodyalign","bodyverticalalign","obj","idx","table","_a","icon","cellText","num"],"sources":["src/components/db-table/db-table.scss?tag=db-table&encapsulation=scoped","src/components/db-table/db-table.tsx"],"sourcesContent":["@import '../general';\n@import 'table';\n","import { Component, h, Prop, Watch } from '@stencil/core';\nimport { TableDataType } from './type';\n\n@Component({\n  tag: 'db-table',\n  styleUrl: 'db-table.scss',\n  scoped: true\n})\nexport class DbTable {\n  private errorTableData: TableDataType = {\n    caption: 'No valid table data provided',\n    headers: ['Error parsing data'],\n    columns: {\n      'Error parsing data': ['please check data']\n    },\n    rows: [\n      {\n        error: [undefined, 'Error parsing data']\n      }\n    ]\n  };\n\n  /**\n   * The tabledata prop receives a stringified object of the type\n   * \"TableDataType\" and sets the initial value of the table.\n   * It can also be set as a property from the outside via JavaScript\n   */\n  @Prop({ reflect: false }) tabledata: string | object;\n\n  /**\n   * Either holds the value of the validated tabledata prop or \"errorTableData\"\n   */\n  private validTableData: TableDataType;\n\n  /**\n   * Validates and sets the value of validTableData upon modification of the\n   * tabledata attribute/property.\n   */\n  @Watch('tabledata')\n  validateTableData(newTableData: TableDataType) {\n    const { caption, headers, columns, rows } = newTableData;\n    const columnKeys =\n      typeof columns === 'object' && columns !== null\n        ? Object.keys(columns)\n        : [];\n    const isHeader = headers?.length > 0;\n    const isRowAndColumn = Array.isArray(rows) && columnKeys.length > 0;\n\n    if (!caption || isRowAndColumn || !isHeader) {\n      // eslint-disable-next-line no-console\n      console.error(\n        'Table data invalid: check caption or headers/columns mismatch'\n      );\n      this.validTableData = this.errorTableData;\n      return;\n    }\n    this.validTableData = newTableData;\n  }\n\n  /**\n   * Validate incoming table data props once on creation because they do not fire @watch\n   */\n  componentWillLoad() {\n    this.validateTableData(this.parseTabularData(this.tabledata));\n  }\n\n  /**\n   * The align prop sets the data-align attribute on the thead\n   * element of the rendered table. Valid values are \"left\" (default), \"center\",\n   * \"bottom\"\n   */\n  @Prop({ reflect: true }) align?: string = '';\n\n  /**\n   * The verticalalign prop sets the data-vertical-align attribute on\n   * the thead element of the rendered table. Valid values are \"top\"\n   * (default), \"middle\", \"bottom\"\n   */\n  @Prop({ reflect: true }) verticalalign?: string = '';\n\n  /**\n   * The bodyalign prop sets the data-align attribute on\n   * the tbody element of the rendered table. Valid values are \"left\"\n   * (default), \"center\", \"bottom\"\n   */\n  @Prop({ reflect: true }) bodyalign?: string = '';\n\n  /**\n   * The bodyverticalalign prop sets the data-vertical-align attribute\n   * on the tbody element of the rendered table. Valid values are \"top\"\n   * (default), \"middle\", \"bottom\"\n   */\n  @Prop({ reflect: true }) bodyverticalalign?: string = '';\n\n  /**\n   * The border prop sets the data-border attribute\n   * on the table element of the rendered table. Valid values are \"around\",\n   * \"horizontal\"\n   */\n  @Prop({ reflect: true }) border?: string = '';\n\n  /**\n   * The density prop sets the data-density attribute\n   * on the table element of the rendered table. Valid values are \"small\",\n   * \"regular\", \"large\"\n   */\n  @Prop({ reflect: true }) density?: string = '';\n\n  /**\n   * The fontsize prop sets the the font size of the style attribute\n   * on the table element of the rendered table.\n   */\n  @Prop({ reflect: true }) fontsize?: string = '1rem';\n\n  /**\n   * The stripes prop sets the the zebra stripes coloring of the rendered table.\n   */\n  @Prop({ reflect: true }) stripes?: string = '';\n\n  /**\n   * The sticky prop sets the table header stickyness of the rendered table.\n   */\n  @Prop({ reflect: true }) sticky?: string = '';\n\n  /**\n   * Without framework (Angular, React, Vue) we will need to pass a tabledata as\n   * string. parseTabularData() will return a fallback so the renderd table can\n   * inform the user about a mismatching value if the string cannot be parsed.\n   */\n  private parseTabularData(item: string | object) {\n    try {\n      if (typeof item === 'string') {\n        return JSON.parse(item);\n      }\n      if (typeof item === 'object') return item;\n    } catch (error) {\n      return this.errorTableData;\n    }\n  }\n\n  /**\n   * We need to know which column of the table is the longest so we can fill\n   * shorter columns with empty cells\n   */\n  private calcColumnLength(\n    tableHeaders: TableDataType['headers'],\n    tableColumns: TableDataType['columns']\n  ) {\n    return tableColumns === undefined\n      ? []\n      : tableHeaders.reduce((prevCol, currentCol) => {\n          return prevCol < tableColumns[currentCol].length\n            ? tableColumns[currentCol].length\n            : prevCol;\n        }, 0);\n  }\n\n  private isRowData(tableData) {\n    return !!Array.isArray(tableData.rows);\n  }\n\n  render() {\n    const isRowData = this.isRowData(this.validTableData);\n    const { caption, headers, columns, rows, rowTitles, rowTitle } =\n      this.validTableData;\n    const maxColumnLength = this.calcColumnLength(headers, columns);\n    const columnIter = [...Array(maxColumnLength).keys()];\n    const showRowTitles = rowTitles?.length > 0;\n\n    return (\n      <div>\n        <table\n          class=\"cmp-table\"\n          data-border={this.border ? this.border : null}\n          data-density={this.density ? this.density : null}\n          style={{ '--table---fontSize': this.fontsize }}\n          data-rows={this.stripes ? this.stripes : null}\n          data-sticky={this.sticky ? this.sticky : null}\n        >\n          <caption>{caption}</caption>\n          <thead\n            data-align={this.align ? this.align : null}\n            data-vertical-align={this.verticalalign ? this.verticalalign : null}\n          >\n            <tr>\n              {rowTitle && <th scope=\"col\">{rowTitle}</th>}\n              {headers.map((head, index) => (\n                <th key={`table-header-${index}`} scope=\"col\">\n                  {head}\n                </th>\n              ))}\n            </tr>\n          </thead>\n          <tbody\n            data-align={this.bodyalign ? this.bodyalign : null}\n            data-vertical-align={\n              this.bodyverticalalign ? this.bodyverticalalign : null\n            }\n          >\n            {isRowData &&\n              rows.map((obj, idx) => {\n                return (\n                  <tr key={`row-${idx}`} class={`row-${idx}`}>\n                    {showRowTitles && <th scope=\"row\">{rowTitles[idx]}</th>}\n                    {headers.map((table, index) => {\n                      // If no row is provided, return empty cell [null, null]\n                      const [icon, cellText] = obj[table] ?? [null, null];\n                      return (\n                        <td key={`cell-${idx}-${index}`}>\n                          {icon && <db-icon icon={icon} />}\n                          {cellText}\n                        </td>\n                      );\n                    })}\n                  </tr>\n                );\n              })}\n            {!isRowData &&\n              columnIter.map((num, idx) => (\n                <tr key={`row-${idx}`} class={`row-${num}`}>\n                  {showRowTitles && <th scope=\"row\">{rowTitles[idx]}</th>}\n                  {headers.map((table, index) => {\n                    const [icon, cellText] = columns[table][idx] ?? [\n                      null,\n                      null\n                    ];\n                    return (\n                      <td key={`cell-${idx}-${index}`}>\n                        {icon && <db-icon icon={icon} />}\n                        {cellText}\n                      </td>\n                    );\n                  })}\n                </tr>\n              ))}\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}